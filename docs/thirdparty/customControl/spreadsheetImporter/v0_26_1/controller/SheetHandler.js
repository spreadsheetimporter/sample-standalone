"use strict";sap.ui.define(["sap/ui/base/ManagedObject","cc/spreadsheetimporter/v0_26_1/thirdparty/xlsx"],function(e,r){"use strict";const a=e.extend("cc.spreadsheetimporter.v0_26_1.SheetHandler",{constructor:function r(){e.prototype.constructor.call(this)}});a.sheet_to_json=function e(a,t){if(a==null||a["!ref"]==null)return[];var n={t:"n",v:0},s=0,i=1,l=[],c=0,o="";var f={s:{r:0,c:0},e:{r:0,c:0}};var u=t||{};var d=u.range!=null?u.range:a["!ref"];if(u.header===1)s=1;else if(u.header==="A")s=2;else if(Array.isArray(u.header))s=3;else if(u.header==null)s=0;switch(typeof d){case"string":f=this.safe_decode_range(d);break;case"number":f=this.safe_decode_range(a["!ref"]);f.s.r=d;break;default:f=d}if(s>0)i=0;var h=r.utils.encode_row(f.s.r);var _=[];var v=[];var w=0,p=0;var b=a["!data"]!=null;var k=f.s.r,y=0;var m={};if(b&&!a["!data"][k])a["!data"][k]=[];var g=u.skipHidden&&a["!cols"]||[];var O=u.skipHidden&&a["!rows"]||[];for(y=f.s.c;y<=f.e.c;++y){if((g[y]||{}).hidden)continue;_[y]=r.utils.encode_col(y);n=b?a["!data"][k][y]:a[_[y]+h];switch(s){case 1:l[y]=y-f.s.c;break;case 2:l[y]=_[y];break;case 3:l[y]=u.header[y-f.s.c];break;default:if(n==null)n={w:"__EMPTY",t:"s"};o=c=r.utils.format_cell(n,null,u);p=m[c]||0;if(!p)m[c]=1;else{do{o=c+"_"+p++}while(m[o]);m[c]=p;m[o]=1}l[y]=o}}for(k=f.s.r+i;k<=f.e.r;++k){if((O[k]||{}).hidden)continue;var A=this.make_json_row(a,f,k,_,s,l,u);if(A.isempty===false||(s===1?u.blankrows!==false:!!u.blankrows))v[w++]=A.row}v.length=w;const j=this.renameAttributes(v);return j};a.make_json_row=function e(a,t,n,s,i,l,c){var o=r.utils.encode_row(n);var f=c.defval,u=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw");var d=true,h=a["!data"]!=null;var _=i===1?[]:{};if(i!==1){if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:n,enumerable:false})}catch(e){_.__rowNum__=n}else _.__rowNum__=n}if(!h||a["!data"][n])for(var v=t.s.c;v<=t.e.c;++v){var w=h?(a["!data"][n]||[])[v]:a[s[v]+o];if(w===undefined||w.t===undefined){if(f===undefined)continue;if(l[v]!=null){_[l[v]]=f}continue}var p=w.v;switch(w.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(l[v]!=null){if(p==null){if(w.t=="e"&&p===null)_[l[v]]=null;else if(f!==undefined)_[l[v]]=f;else if(u&&p===null)_[l[v]]=null;else continue}else{_[l[v]]=w}if(p!=null)d=false}}return{row:_,isempty:d}};a.safe_decode_range=function e(r){var a={s:{c:0,r:0},e:{c:0,r:0}};var t=0,n=0,s=0;var i=r.length;for(t=0;n<i;++n){if((s=r.charCodeAt(n)-64)<1||s>26)break;t=26*t+s}a.s.c=--t;for(t=0;n<i;++n){if((s=r.charCodeAt(n)-48)<0||s>9)break;t=10*t+s}a.s.r=--t;if(n===i||s!=10){a.e.c=a.s.c;a.e.r=a.s.r;return a}++n;for(t=0;n!=i;++n){if((s=r.charCodeAt(n)-64)<1||s>26)break;t=26*t+s}a.e.c=--t;for(t=0;n!=i;++n){if((s=r.charCodeAt(n)-48)<0||s>9)break;t=10*t+s}a.e.r=--t;return a};a.renameAttributes=function e(r){const a=e=>{Object.keys(e).forEach(r=>{if(e[r].hasOwnProperty("v")){e[r].rawValue=e[r].v;delete e[r].v}if(e[r].hasOwnProperty("t")){e[r].sheetDataType=e[r].t;delete e[r].t}if(e[r].hasOwnProperty("z")){e[r].format=e[r].z;delete e[r].z}if(e[r].hasOwnProperty("w")){e[r].formattedValue=e[r].w;delete e[r].w}});return e};return r.map(a)};return a});
//# sourceMappingURL=SheetHandler.js.map