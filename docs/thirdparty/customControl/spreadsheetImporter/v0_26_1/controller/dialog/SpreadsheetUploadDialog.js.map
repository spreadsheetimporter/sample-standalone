{"version":3,"file":"SpreadsheetUploadDialog.js","names":["sap","ui","define","ManagedObject","Fragment","MessageToast","__Preview","__Util","XLSX","__OptionsDialog","Log","__SheetHandler","__Parser","JSONModel","_interopRequireDefault","obj","__esModule","default","Preview","Util","OptionsDialog","SheetHandler","Parser","SpreadsheetUploadDialog","extend","constructor","_constructor","spreadsheetUploadController","component","componentI18n","messageHandler","prototype","call","this","util","getResourceBundle","previewHandler","optionsHandler","createSpreadsheetUploadDialog","async","_createSpreadsheetUploadDialog","spreadsheetUploadDialog","spreadsheetOptionsModel","dataRows","strict","getStrict","hidePreview","getHidePreview","showOptions","getShowOptions","load","name","type","controller","setComponent","setBusyIndicatorDelay","setModel","getModel","attachDecimalSeparatorChanged","onDecimalSeparatorChanged","bind","attachAvailableOptionsChanged","onAvailableOptionsChanged","getStandalone","getColumns","length","getSubHeader","setVisible","getContentLeft","onFileUpload","_onFileUpload","event","setMessages","file","getParameter","workbook","_readWorkbook","isStandalone","readAllSheets","getReadAllSheets","spreadsheetSheetsData","columnNames","sheetName","Object","keys","Sheets","currSheetData","sheet_to_json","dataVal","forEach","key","concat","utils","header","SheetNames","Error","geti18nText","object","rawValue","trim","checkFormat","checkMandatoryColumns","odataKeyList","getMandatoryFields","typeLabelList","checkColumnNames","getFieldMatchType","payload","fireCheckBeforeRead","sheetData","payloadArray","parseSpreadsheetData","isODataV4","areMessagesPresent","displayMessages","setDataRows","error","showError","resetContent","onUploadSet","_onUploadSet","isDefaultNotPrevented","fireUploadButtonPress","rawData","_extractRawValues","parsedData","_extractParsedValues","onCloseDialog","show","that","source","getSource","sourceParent","getParent","setBusy","sleep","fnAddMessage","Promise","fnResolve","fnReject","getODataHandler","callOdata","mParameters","busy","set","check","dataloss","popup","navigation","sActionLabel","context","editFlow","securedExecution","extensionAPI","openSpreadsheetUploadDialog","_openSpreadsheetUploadDialog","open","_onCloseDialog","close","_onDecimalSeparatorChanged","setDecimalSeparator","_onAvailableOptionsChanged","availableOptions","setShowOptions","setProperty","setAvailableOptions","_resetContent","fileUploader","getContent","getItems","setValue","_setDataRows","getDialog","_getDialog","showPreview","_showPreview","getPayloadArray","onTempDownload","_onTempDownload","fieldMatchType","worksheet","colWidths","sampleData","getSampleData","colWidthDefault","colWidthDate","col","rows","column","encode_cell","c","r","v","t","value","entries","cell","label","index","data","sampleDataValue","toString","push","wch","newStr","maxLength","substring","format","currentLang","getCore","getConfiguration","getLanguage","startsWith","Date","z","decimalSeparator","getDecimalSeparator","getHideSampleData","encode_range","s","e","wb","book_new","book_append_sheet","writeFile","getSpreadsheetFileName","onOpenOptionsDialog","_onOpenOptionsDialog","openOptionsDialog","resolve","reject","buffer_RS","stream","read","cellNF","cellDates","cellText","cellFormula","_buffer_RS","buffers","reader","getReader","res","done","out","Uint8Array","reduce","acc","off","u8","map","item","newObj","hasOwnProperty","formattedValue"],"sources":["SpreadsheetUploadDialog-dbg.js"],"mappings":"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"}