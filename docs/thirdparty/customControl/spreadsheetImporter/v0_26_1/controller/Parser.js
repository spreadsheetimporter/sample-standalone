"use strict";sap.ui.define(["sap/ui/base/ManagedObject","sap/ui/core/library","./Util","../enums"],function(e,t,s,a){"use strict";function i(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const r=t["MessageType"];const n=i(s);const o=a["CustomMessageTypes"];const l=e.extend("cc.spreadsheetimporter.v0_26_1.Parser",{});l.parseSpreadsheetData=function e(t,s,a,i,r,o){const l=[];for(const[e,c]of t.entries()){let t={};for(const[l,g]of s.entries()){const s=n.getValueFromRow(c,g.label,l,a.getFieldMatchType());if(s&&s.rawValue!==undefined&&s.rawValue!==null&&s.rawValue!==""){const n=s.rawValue;if(g.type==="Edm.Boolean"){if(typeof n==="boolean"||n==="true"||n==="false"){t[l]=Boolean(n)}else{this.addMessageToMessages("valueNotABoolean",r,i,e,[g.label],n)}}else if(g.type==="Edm.Date"){let a=n;if(s.sheetDataType!=="d"){const t=new Date(n);if(isNaN(t.getTime())){this.addMessageToMessages("valueNotADate",r,i,e,[g.label],n);continue}a=t}try{this.checkDate(a,g,r,i,e);const s=`${a.getFullYear()}-${("0"+(a.getMonth()+1)).slice(-2)}-${("0"+a.getDate()).slice(-2)}`;t[l]=s}catch(t){this.addMessageToMessages("errorWhileParsing",r,i,e,[g.label],n)}}else if(g.type==="Edm.DateTimeOffset"||g.type==="Edm.DateTime"){let a=n;if(s.sheetDataType!=="d"){const t=new Date(n);if(isNaN(t.getTime())){this.addMessageToMessages("valueNotADate",r,i,e,[g.label],n);continue}a=t}try{this.checkDate(a,g,r,i,e);t[l]=a}catch(t){this.addMessageToMessages("errorWhileParsing",r,i,e,[g.label],n)}}else if(g.type==="Edm.TimeOfDay"||g.type==="Edm.Time"){let a=n;if(s.sheetDataType!=="d"){const t=new Date(n);if(isNaN(t.getTime())){this.addMessageToMessages("valueNotADate",r,i,e,[g.label],n);continue}a=t}try{this.checkDate(a,g,r,i,e);const s=a.toISOString().substring(11,16);t[l]=s}catch(t){this.addMessageToMessages("errorWhileParsing",r,i,e,[g.label],n)}}else if(g.type==="Edm.UInt8"||g.type==="Edm.Int16"||g.type==="Edm.Int32"||g.type==="Edm.Integer"||g.type==="Edm.Int64"||g.type==="Edm.Integer64"){try{const n=this.checkInteger(s,g,r,i,e,a);if(o){if(g.type==="Edm.Int64"||g.type==="Edm.Integer64"){t[l]=n.toString()}else{t[l]=n}}else{if(g.type==="Edm.Int16"||g.type==="Edm.Int32"){t[l]=n}else{t[l]=n.toString()}}}catch(t){this.addMessageToMessages("errorWhileParsing",r,i,e,[g.label],n)}}else if(g.type==="Edm.Double"||g.type==="Edm.Decimal"){try{const n=this.checkDouble(s,g,r,i,e,a);if(o){if(g.type==="Edm.Double"){t[l]=n}if(g.type==="Edm.Decimal"){t[l]=n.toString()}}else{t[l]=n.toString()}}catch(t){this.addMessageToMessages("errorWhileParsing",r,i,e,[g.label],n)}}else{t[l]=`${n||""}`}}}l.push(t)}return l};l.checkDate=function e(t,s,a,i,r){if(isNaN(t.getTime())){this.addMessageToMessages("invalidDate",a,i,r,[s.label],t.rawValue);return false}return true};l.checkDouble=function e(t,s,a,i,r,o){const l=t.rawValue;let c=l;if(typeof l==="string"){const e=n.normalizeNumberString(l,o);c=parseFloat(e);if(/[^0-9.,]/.test(c)||parseFloat(e).toString()!==e){this.addMessageToMessages("parsingErrorNotNumber",a,i,r,[s.label],l)}}return c};l.checkInteger=function e(t,s,a,i,r,o){const l=t.rawValue;let c=l;if(!Number.isInteger(c)){if(typeof l==="string"){const e=n.normalizeNumberString(l,o);c=parseInt(e);if(/[^0-9]/.test(c)||parseInt(e).toString()!==e.toString()){this.addMessageToMessages("parsingErrorNotWholeNumber",a,i,r,[s.label],l)}}}return c};l.addMessageToMessages=function e(t,s,a,i,n,l,c){a.addMessageToMessages({title:s.geti18nText(t,n),row:i+2,type:o.ParsingError,counter:1,rawValue:l,formattedValue:c,ui5type:r.Error})};return l});
//# sourceMappingURL=Parser.js.map